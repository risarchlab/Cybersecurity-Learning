# SUID Binary Exploitation - Identifying Unusual Binaries

**Date:** February 18, 2026  
**Platform:** HackTheBox Academy  
**Module:** Linux Privilege Escalation

**Difficulty:** Easy  
**Status:** âœ… Completed

---

## ğŸ¯ Objective
Find a SUID binary that was not shown in the training material example output.

## ğŸ“š Background Knowledge

### What is SUID?
The **Set User ID (SUID)** bit is a special file permission that allows a user to execute a program with the permissions of the file owner (often root).

**Analogy:** It's like borrowing someone's car keys - while you're driving, you have their driving privileges!

### Why is SUID Dangerous?
If a SUID binary can be exploited, an attacker can escalate privileges to root.

---

## ğŸ” Enumeration

### Command Used
```bash
find / -user root -perm -4000 -exec ls -ldb {} \; 2>/dev/null
```

**Command Breakdown:**
- `find /` - Search from root directory
- `-user root` - Files owned by root
- `-perm -4000` - Files with SUID bit set (the "4" = SUID)
- `-exec ls -ldb {} \;` - List details of found files
- `2>/dev/null` - Hide error messages

### Results
<img width="1209" height="1162" alt="image" src="https://github.com/user-attachments/assets/a1a4cff1-ad0b-4cf4-95ed-f42e8c740146" />


---

## ğŸ§  Analysis Process

### Expected SUID Binaries (Normal):
These NEED elevated privileges for their job:
- `/bin/su` - Switch user
- `/bin/mount`, `/bin/umount` - Mount filesystems
- `/usr/bin/sudo` - Execute as another user
- `/usr/bin/passwd` - Change passwords
- `/usr/bin/chsh`, `/usr/bin/chfn` - Change user info
- `/usr/lib/snapd/snap-confine` - Snap package management

### Suspicious SUID Binary Found:
**`/bin/sed`** âš ï¸

**Why is this unusual?**
- `sed` is a **stream editor** for text processing
- It does NOT need root privileges for normal operation
- Finding it with SUID is a major red flag!

---

## âœ… Answer
```
/bin/sed
```

---

## ğŸ’¡ Key Learning: Building a Mental "SUID Whitelist"

### The Pattern Recognition Framework

**Ask 3 Questions:**

1. **"Does this program NEED root permissions for its normal job?"**
   - `passwd` â†’ YES (modifies `/etc/shadow`)
   - `sed` â†’ NO (just edits text streams)

2. **"Is this on GTFOBins?"**
   - If yes â†’ Potentially exploitable!

3. **"Would I be surprised to see this with SUID?"**
   - Surprised by `sed`? â†’ INVESTIGATE!

### Common Suspicious SUID Binaries
If you find these with SUID, investigate immediately:
- Text editors: `vim`, `nano`, `ed`, `sed`
- File viewers: `less`, `more`, `tail`, `head`
- Scripting: `python`, `perl`, `ruby`, `bash`
- File utilities: `cp`, `mv`, `tar`, `zip`, `find`

---

## ğŸš€ Exploitation Path (Theoretical)

If we wanted to exploit `/bin/sed` with SUID, we could use GTFOBins:
```bash
sed -n '1e exec sh 1>&0' /etc/hosts
```

This would spawn a root shell!

**Why it works:**
- `sed` has SUID â†’ runs as root
- `-n '1e exec sh'` â†’ executes shell command
- Result: root shell! ğŸ¯

---

## ğŸ“Š Comparison Table

| Binary | Normal Use | Should Have SUID? | Exploitable? |
|--------|-----------|------------------|--------------|
| `/bin/su` | Switch user | âœ… YES | No (intended) |
| `/usr/bin/passwd` | Change password | âœ… YES | No (intended) |
| `/bin/mount` | Mount filesystems | âœ… YES | No (intended) |
| `/bin/sed` | Text editing | âŒ NO | âœ… YES (GTFOBins) |
| `/usr/bin/vim` | Text editing | âŒ NO | âœ… YES (GTFOBins) |
| `/usr/bin/find` | Find files | âŒ NO | âœ… YES (GTFOBins) |

---

## ğŸ“ How I Figured It Out

### Initial Approach (Wrong):
I first looked at the obvious custom binaries:
- `/home/htb-student/shared_obj_hijack/payroll`
- `/home/mrb3n/payroll`
- `/home/cliff.moore/netracer`

âŒ These weren't the answer!

### Corrected Approach:
1. Re-read the output carefully
2. Applied the "Does this make sense?" filter
3. Realized `sed` in `/bin/` with SUID is **highly abnormal**
4. Checked GTFOBins - confirmed it's exploitable
5. Submitted `/bin/sed` â†’ âœ… Correct!

---

## ğŸ“š Resources
- [GTFOBins - sed](https://gtfobins.github.io/gtfobins/sed/)
- [Linux SUID/SGID Permissions](https://www.redhat.com/sysadmin/suid-sgid-sticky-bit)
- [HackTheBox Academy - Privilege Escalation](https://academy.hackthebox.com)

---

## ğŸ·ï¸ Tags
`#Linux` `#PrivilegeEscalation` `#SUID` `#BinaryExploitation` `#GTFOBins` `#Enumeration` `#HackTheBox` `#PenTestPlus`

---

## âœ… Mapped to Certifications
- **PenTest+:** Domain 3 - Exploitation (Binary Analysis, Privilege Escalation)
- **CySA+:** Domain 2 - Threat Detection (Understanding attack techniques)
- **Linux+:** File permissions and security models
